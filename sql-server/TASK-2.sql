USE ABHINAV;

/* EMPLOYEE TABLE STORES EMPLOYEE DETAILS ONLY */
CREATE TABLE EMPLOYEE(
ID INT IDENTITY(1,1) PRIMARY KEY,
NAME VARCHAR(55),
LEAVES INT,
CITY VARCHAR(55)
);

/* BANK TABLE STORES THE BANK DETAILS ONLY */
CREATE TABLE BANK(
ACC_NUMBER INT IDENTITY(50,1) PRIMARY KEY,
NAME VARCHAR(55),
ACOUNT_OPEN DATETIME,
IFSC VARCHAR(10)
);

/* SALARY TABLE STORES THE DETAILS OF THE SALARY */
CREATE TABLE SALARY (
TXN_NO INT IDENTITY(101,1) PRIMARY KEY,
FOR_MONTH DATETIME,
CREDIT_DATE DATETIME,
AMOUNT MONEY
);

/* ADDING FOREIGN KEY IN SALARY TABLE TO LINK BOTH THE TABLES*/

ALTER TABLE SALARY
ADD ID INT;

ALTER TABLE SALARY
ALTER COLUMN ID INT NOT NULL;

ALTER TABLE SALARY 
ADD CONSTRAINT ID FOREIGN KEY (ID) REFERENCES EMPLOYEE(ID);

/* ADDING FOREIGN KEY IN BANK TABLE TO LINK BOTH THE TABLES*/

ALTER TABLE BANK
ADD E_ID INT;

ALTER TABLE BANK
ALTER COLUMN E_ID INT NOT NULL;

ALTER TABLE BANK 
ADD CONSTRAINT E_ID FOREIGN KEY (E_ID) REFERENCES EMPLOYEE(ID);

/* --------------------------------------- */
SELECT * FROM SALARY;
SELECT * FROM BANK;

EXEC SP_COLUMNS BANK;
EXEC SP_COLUMNS SALARY;


INSERT INTO EMPLOYEE(NAME,LEAVES,CITY) VALUES ('RAHUL TANEJA',10,'PATNA'),('ROHIT KUSHWAHA',0,'KANPUR')
,('MOHIT YADAV',2,'PUNE'),('SUNITA CHAUHAN',0,'DELHI');

SELECT * FROM EMPLOYEE;

INSERT INTO BANK(NAME,ACOUNT_OPEN,IFSC,E_ID) VALUES
('BANK OF BARODA','2022-12-21 17:36','PYTM01234',1),
('HDFC','2022-12-21 17:36','PYTM01234',2),
('CANRA BANK','2022-12-21 17:36','PYTM01234',3),
('PUNJAB NATIONAL BANK','2022-12-21 17:36','PYTM01234',4);


INSERT INTO SALARY (FOR_MONTH,CREDIT_DATE,AMOUNT,ID) VALUES
('2023-11-01','2023-12-01',20000,1),
('2023-11-01','2023-12-01',30000,2),
('2023-11-01','2023-12-01',30000,3),
('2023-11-01','2023-12-01',30000,4);


INSERT INTO SALARY (FOR_MONTH,CREDIT_DATE,AMOUNT,ID) VALUES
('2023-12-01','2024-01-01',20000,1),
('2023-12-01','2024-01-01',30000,2),
('2023-12-01','2024-01-01',30000,3),
('2023-12-01','2024-01-01',30000,4);

SELECT * FROM SALARY;
SELECT * FROM BANK;
SELECT * FROM EMPLOYEE;

SELECT SALARY.CREDIT_DATE ,SALARY.FOR_MONTH,SALARY.AMOUNT,EMPLOYEE.NAME
FROM SALARY
INNER JOIN EMPLOYEE ON EMPLOYEE.ID = SALARY.ID WHERE EMPLOYEE.ID = 2;